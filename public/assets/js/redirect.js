const redirectScript = `
document.addEventListener("DOMContentLoaded",function(){sessionStorage.getItem("hasRedirected")&&dataMapping.forEach(({selector:e,variant:t,slug:s})=>{let n=document.querySelectorAll(e);n.forEach(n=>{let o=!1,i=!1,a=()=>{let n=window.location.host+window.location.pathname;if(n.includes(s)){let o={url:n,selector:e,variant:t,token:token};(function e(t){fetch("https://split.esensigroup.com/tracker-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>console.log("Success:",e)).catch(e=>console.error("Error:",e))})(o),console.log("Data sent to API:",o)}else console.log("Current URL does not match slug:",s)},l=s+"_"+e+"_submitted";"FORM"===n.tagName?n.classList.contains("wpcf7-form")?(document.addEventListener("wpcf7mailsent",t=>{!t.target.matches(e)||o||sessionStorage.getItem(l)||(o=!0,a(),sessionStorage.setItem(l,"true"),console.log("Contact Form 7 sent successfully, data sent."))}),document.addEventListener("wpcf7invalid",t=>{t.target.matches(e)&&console.log("Contact Form 7 submission invalid, data not sent.")})):n.addEventListener("submit",async e=>{if(e.preventDefault(),!o&&!sessionStorage.getItem(l)){o=!0;try{let t=new FormData(n),s=await fetch(n.action,{method:"POST",body:t});s.ok?(a(),sessionStorage.setItem(l,"true"),console.log("Non-Contact Form 7 form submitted successfully, data sent.")):console.log("Form submission failed, data not sent.")}catch(i){console.error("Error submitting form:",i)}finally{o=!1}}}):n.addEventListener("click",()=>{i||sessionStorage.getItem(l)?console.log("Element already clicked in this session."):(i=!0,a(),sessionStorage.setItem(l,"true"),console.log("Non-form element clicked, data sent."))})})}),fetch("https://split.esensigroup.com/get-domain/"+token,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{let t=e.domain_name,s=window.location.host+window.location.pathname,n=s.replace("www.","").replace(/\/$/,""),o=t.replace("www.","").replace(/\/$/,"");if(n.includes(o)){!function e(t){let s=t,n="baseUrl_viewDataSent";if(s&&"string"==typeof s&&(s=(s=s.replace("http://","").replace("https://","")).replace("www.","")),sessionStorage.getItem(n))console.log("View data already sent for the base URL in this session.");else{let o={slug:s,token:token};(function e(t){fetch("https://split.esensigroup.com/base-view-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>console.log("Success:",e)).catch(e=>console.error("Error:",e))})(o),sessionStorage.setItem(n,"true")}}(t);let i=dataMapping[Math.floor(Math.random()*dataMapping.length)],a=localStorage.getItem(i.slug+"_hits")?parseInt(localStorage.getItem(i.slug+"_hits")):0;a++,localStorage.setItem(i.slug+"_hits",a),sessionStorage.setItem("hasRedirected","true"),document.body.style.visibility="hidden",setTimeout(()=>{document.body.innerHTML='<div style="display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #fff;"><img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExajFnazV4bnE2M3NzY2hxeDhzd3J2ODdxamE2dmNvdTU1bGZvNm9tNyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3oEjI6SIIHBdRxXI40/giphy.gif" /></div>',document.body.style.visibility="visible",setTimeout(()=>{window.location.href="https://"+i.slug},500)},1e3)}}).catch(e=>console.error("Error:",e))}),sessionStorage.getItem("hasRedirected")&&function e(){let t=window.location.host+window.location.pathname,s=dataMapping.find(e=>t.includes(e.slug));if(s){let n=s.slug+"_viewDataSent";if(sessionStorage.getItem(n))console.log("View data already sent for this user in this session.");else{let o={slug:s.slug,token:token};(function e(t){fetch("https://split.esensigroup.com/view-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>console.log("Success:",e)).catch(e=>console.error("Error:",e))})(o),sessionStorage.setItem(n,"true")}}else console.log("No matching URL found.")}();
`;
