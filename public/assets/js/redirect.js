const redirectScript = `
document.addEventListener("DOMContentLoaded",function(){if(!function t(){let e=window.location.origin,n="baseUrl_viewDataSent";if(e&&"string"==typeof e&&(e=(e=e.replace("http://","").replace("https://","")).replace("www.","")),sessionStorage.getItem(n))console.log("View data already sent for the base URL in this session.");else{let s={slug:e,token:token};(function t(e){fetch("https://split.esensigroup.com/base-view-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>t.json()).then(t=>console.log("Success:",t)).catch(t=>console.error("Error:",t))})(s),sessionStorage.setItem(n,"true")}}(),!function t(){let e=window.location.host+window.location.pathname,n=dataMapping.find(t=>e.includes(t.slug));if(n){console.log("Matching URL found:",n.slug);let s=n.slug+"_viewDataSent";if(sessionStorage.getItem(s))console.log("View data already sent for this user in this session.");else{let o={slug:n.slug,token:token};(function t(e){fetch("https://split.esensigroup.com/view-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>t.json()).then(t=>console.log("Success:",t)).catch(t=>console.error("Error:",t))})(o),sessionStorage.setItem(s,"true")}}else console.log("No matching URL found.")}(),dataMapping.forEach(({selector:t,variant:e,slug:n})=>{let s=document.querySelectorAll(t);s.forEach(s=>{let o=!1,i=!1,a=()=>{let s=window.location.host+window.location.pathname;if(s.includes(n)){let o={url:s,selector:t,variant:e,token:token};(function t(e){fetch("https://split.esensigroup.com/tracker-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>t.json()).then(t=>console.log("Success:",t)).catch(t=>console.error("Error:",t))})(o),console.log("Data sent to API:",o)}else console.log("Current URL does not match slug:",n)};"FORM"===s.tagName?s.classList.contains("wpcf7-form")?(document.addEventListener("wpcf7mailsent",e=>{e.target.matches(t)&&!o&&(o=!0,a(),console.log("Contact Form 7 sent successfully, data sent."))}),document.addEventListener("wpcf7invalid",e=>{e.target.matches(t)&&console.log("Contact Form 7 submission invalid, data not sent.")})):s.addEventListener("submit",async t=>{if(t.preventDefault(),!o){o=!0;try{let e=new FormData(s),n=await fetch(s.action,{method:"POST",body:e});n.ok?(a(),console.log("Non-Contact Form 7 form submitted successfully, data sent.")):console.log("Form submission failed, data not sent.")}catch(i){console.error("Error submitting form:",i)}finally{o=!1}}}):s.addEventListener("click",()=>{i?console.log("Element already clicked."):(i=!0,a(),console.log("Non-form element clicked, data sent."))})})}),sessionStorage.getItem("hasRedirected"))return;let t=dataMapping[Math.floor(Math.random()*dataMapping.length)],e=localStorage.getItem(t.slug+"_hits")?parseInt(localStorage.getItem(t.slug+"_hits")):0;e++,localStorage.setItem(t.slug+"_hits",e),sessionStorage.setItem("hasRedirected","true"),document.body.style.visibility="hidden",setTimeout(()=>{document.body.innerHTML='<div style="display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #fff;"> <img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExajFnazV4bnE2M3NzY2hxeDhzd3J2ODdxamE2dmNvdTU1bGZvNm9tNyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3oEjI6SIIHBdRxXI40/giphy.gif"  /> </div>',document.body.style.visibility="visible",setTimeout(()=>{window.location.href=t.slug},500)},1e3)});
`;
